<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>çŒ«å’ªå åœæœº Â· Cat Oracle</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Tailwind è‡ªå®šä¹‰ä¸»é¢˜ï¼ˆæŸ”å’Œé…è‰²ï¼‰
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: [
                "system-ui",
                "-apple-system",
                "BlinkMacSystemFont",
                "Segoe UI",
                "sans-serif",
              ],
            },
            colors: {
              catbg: "#f8fafc",
              catCard: "#ffffff",
              catAccent: "#fbbf24",
              catAccentSoft: "#fde68a",
              catTextSoft: "#64748b",
            },
            boxShadow: {
              cat: "0 18px 45px rgba(15,23,42,0.15)",
            },
          },
        },
      };
    </script>

    <style>
      /* çŒ«å’ªè½»å¾®å‘¼å¸åŠ¨ç”» */
      @keyframes cat-breathe {
        0% {
          transform: translateY(0) scale(1);
        }
        50% {
          transform: translateY(-4px) scale(1.03);
        }
        100% {
          transform: translateY(0) scale(1);
        }
      }

      /* è½»å¾®æŠ–åŠ¨ï¼Œç”¨äºåç»­äº¤äº’ï¼ˆå…ˆé¢„ç•™ï¼‰ */
      @keyframes cat-shake-soft {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-3px);
        }
        50% {
          transform: translateX(3px);
        }
        75% {
          transform: translateX(-2px);
        }
      }

      .cat-breathe {
        animation: cat-breathe 3s ease-in-out infinite;
        transform-origin: center bottom;
      }

      /* è½»å¾®æŠ–åŠ¨ï¼šçŸ­ä¿ƒçš„å‘¼å™œåé¦ˆ */
      .cat-shake {
        animation: cat-shake-soft 260ms ease-in-out;
      }

      /* ç»“æœç™½å…‰é®ç½© */
      @keyframes cat-flash {
        0% {
          opacity: 0;
        }
        45% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }

      .flash-active {
        animation: cat-flash 650ms ease-out;
      }

      /* ç­”æ¡ˆå¡ç‰‡æ‰è½ + å¼¹è·³ */
      @keyframes card-drop-bounce {
        0% {
          transform: translate3d(0, -40vh, 0) scale(0.9) rotate(-3deg);
          opacity: 0;
        }
        40% {
          transform: translate3d(0, 6%, 0) scale(1) rotate(1deg);
          opacity: 1;
        }
        62% {
          transform: translate3d(0, -4%, 0) scale(1.01) rotate(-1deg);
        }
        78% {
          transform: translate3d(0, 0%, 0) scale(1) rotate(0deg);
        }
        100% {
          transform: translate3d(0, 0%, 0) scale(1) rotate(0deg);
          opacity: 1;
        }
      }

      .card-enter {
        animation: card-drop-bounce 700ms cubic-bezier(0.22, 0.68, 0, 1.02)
          forwards;
      }

      /* ç²’å­ï¼šé£˜èµ·çš„å°æ˜Ÿæ˜Ÿ / è‚‰å« */
      @keyframes particle-pop {
        0% {
          transform: translate3d(0, 0, 0) scale(0.6);
          opacity: 0;
        }
        15% {
          opacity: 1;
        }
        100% {
          transform: translate3d(var(--dx, 0px), var(--dy, -36px), 0)
            scale(1.1);
          opacity: 0;
        }
      }

      .particle {
        position: absolute;
        font-size: 14px;
        pointer-events: none;
        animation: particle-pop 600ms ease-out forwards;
        will-change: transform, opacity;
      }

      /* æ©˜çŒ«é€ å‹ */
      .cat-figure {
        position: relative;
        width: 70%;
        max-width: 230px;
        aspect-ratio: 1 / 1;
        margin: 0 auto;
        background-image: url("cats.png");
        background-size: 200% 200%;
        background-repeat: no-repeat;
        background-position: 0% 0%;
        border-radius: 26%;
        box-shadow: 0 18px 45px rgba(15, 23, 42, 0.14);
      }
    </style>
  </head>

  <body
    class="min-h-screen flex flex-col bg-gradient-to-b from-[#fff7ed] via-[#fff1f2] to-[#fef3c7]"
  >
    <!-- æ•´ä½“å®¹å™¨ï¼šå‚ç›´å±…ä¸­ -->
    <main
      class="flex-1 flex flex-col items-center justify-center px-6 pb-28 pt-10"
    >
      <!-- æ ‡é¢˜ä¸è¯´æ˜ -->
      <section class="text-center mb-8">
        <h1 class="text-2xl font-semibold text-slate-800 mb-2">
          çŒ«å’ªå åœæœº
        </h1>
        <p class="text-sm text-catTextSoft">
          ç”¨æ‰‹è½»è½»åœ°ã€è€å¿ƒåœ°æ‘¸çŒ«ï¼Œç­‰çŒ«å’ªæ”’å¤Ÿäº†èƒ½é‡ï¼Œå°±ä¼šç»™ä½ ä¸€æ¡å¸¦çŒ«å‘³çš„ç­”æ¡ˆã€‚
        </p>
      </section>

      <!-- çŒ«å’ªäº’åŠ¨åŒºåŸŸ -->
      <section
        id="cat-area"
        class="relative w-full max-w-xs sm:max-w-sm aspect-square mx-auto select-none"
      >
        <div
          id="cat-hit-area"
          class="w-full h-full rounded-3xl bg-gradient-to-b from-[#fff7ed] to-[#fed7aa] shadow-cat flex items-center justify-center overflow-hidden cursor-pointer"
        >
          <!-- ç²¾çµå›¾æ©˜çŒ« -->
          <div
            id="cat-figure"
            class="cat-figure cat-breathe"
            aria-label="ä¸€åªæ­£åœ¨æ‰“ç›¹çš„æ©˜çŒ«"
          ></div>
        </div>

        <!-- ç»“æœç™½å…‰é®ç½© -->
        <div
          id="result-flash"
          class="pointer-events-none absolute inset-0 rounded-3xl bg-white"
          style="opacity: 0"
        ></div>

        <!-- ç­”æ¡ˆå¡ç‰‡ -->
        <div
          id="answer-card"
          class="invisible opacity-0 fixed inset-0 z-30 flex items-center justify-center transition-opacity duration-300"
        >
          <div
            id="answer-card-inner"
            class="w-[88vw] max-w-sm bg-white/70 backdrop-blur-[10px] rounded-[26px] border border-white/60 shadow-[0_24px_60px_rgba(15,23,42,0.35)] px-6 py-5 sm:px-7 sm:py-6"
          >
            <div
              id="answer-type-pill"
              class="inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium mb-1.5 bg-amber-50 text-amber-700"
            >
              çŒ«å’ªæ­£åœ¨æ€è€ƒâ€¦
            </div>
            <p
              id="answer-main"
              class="text-lg sm:text-2xl font-semibold text-slate-800 mb-3 leading-snug"
            >
              â€¦
            </p>
            <p
              id="answer-detail"
              class="text-sm sm:text-base text-slate-700/80 leading-relaxed"
            >
              ç­‰çŒ«å’ªç»™ä½ ä¸€ä¸ªæ­£å¼çš„ç­”æ¡ˆã€‚
            </p>
            <button
              id="answer-dismiss"
              type="button"
              class="mt-3 inline-flex items-center text-[11px] sm:text-xs text-catTextSoft hover:text-slate-800 transition-colors"
            >
              æ”¶å¥½è¿™æ¡çŒ«å¼å»ºè®®
            </button>
          </div>
        </div>

        <!-- è½»å¾®çš„æç¤ºæ–‡å­— -->
        <p
          class="absolute -bottom-8 left-1/2 -translate-x-1/2 text-xs text-catTextSoft"
        >
          åœ¨çŒ«èº«ä¸Šæ¥å›æ»‘åŠ¨ / è½»æŠš
        </p>
      </section>
    </main>

    <!-- åº•éƒ¨éšè—è‚‰å«è¿›åº¦æ¡ -->
    <footer
      class="fixed inset-x-0 bottom-0 px-5 pb-6 pt-3 bg-gradient-to-t from-white/90 via-white/80 to-transparent backdrop-blur-sm"
    >
      <div
        id="progress-wrapper"
        class="max-w-md mx-auto opacity-0 translate-y-3 transition-all duration-500"
      >
        <div class="flex items-center justify-between mb-1">
          <span class="text-xs font-medium text-slate-700">çŒ«å’ªèƒ½é‡</span>
          <span
            id="progress-label"
            class="text-[11px] text-catTextSoft tracking-wide"
            >æ‘¸ä¸€æ‘¸è¯•è¯•çœ‹</span
          >
        </div>

        <!-- è‚‰å«æ§½ -->
        <div
          class="relative h-4 rounded-full bg-slate-200/80 overflow-hidden shadow-inner"
        >
          <!-- èƒŒæ™¯è‚‰å«çº¹ç†ï¼ˆç®€å•ç‰ˆï¼šæ¸å˜ï¼‰ -->
          <div
            class="absolute inset-0 bg-[radial-gradient(circle_at_10%_50%,#fecaca_0,#fecaca_28%,transparent_30%),radial-gradient(circle_at_35%_50%,#fed7aa_0,#fed7aa_26%,transparent_30%),radial-gradient(circle_at_60%_50%,#fed7aa_0,#fed7aa_26%,transparent_30%),radial-gradient(circle_at_85%_50%,#fecaca_0,#fecaca_28%,transparent_30%)] opacity-60 pointer-events-none"
          ></div>

          <!-- è¿›åº¦æ¡ä¸»ä½“ -->
          <div
            id="progress-bar"
            class="absolute inset-y-0 left-0 w-0 bg-gradient-to-r from-amber-300 via-amber-400 to-amber-500 rounded-full transition-[width] duration-300 ease-out"
          ></div>
        </div>

        <!-- å°æç¤º paw -->
        <div class="mt-1.5 flex items-center justify-end gap-1">
          <span class="text-[10px] text-catTextSoft">è‚‰å«å……èƒ½ä¸­</span>
          <span class="text-xs">ğŸ¾</span>
        </div>
      </div>
    </footer>

    <!-- é¢„ç•™éŸ³é¢‘æ¥å£ -->
    <audio id="audio-purr" src="purr.mp3" preload="auto"></audio>
    <audio id="audio-meow" src="meow.mp3" preload="auto"></audio>
    <audio id="audio-paper" src="paper.mp3" preload="auto"></audio>

    <!-- æ ¸å¿ƒè„šæœ¬ï¼šèƒ½é‡è¿›åº¦é€»è¾‘ & ç­”æ¡ˆåº“ -->
    <script>
      // çŒ«å¼å“²å­¦ç­”æ¡ˆåº“ï¼ˆæŒ‰çŒ«å’ªé¢œè‰²/æ€§æ ¼åˆ†ç±»ï¼‰
      const catAnswers = [
        // ç™½çŒ« - æ¸©æŸ”ç±»
        {
          cat: "white",
          text: "è¹­è¹­ä½ ï¼Œä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥çš„ã€‚",
          detail: "æœ‰æ—¶å€™åœä¸‹æ¥é—­ä¸Šçœ¼ï¼Œå°±èƒ½æ„Ÿå—åˆ°é˜³å…‰çš„æ¸©åº¦ã€‚",
        },
        {
          cat: "white",
          text: "ä½ åœ¨å‘å…‰ï¼Œåªæ˜¯ä½ è‡ªå·±æ²¡å¯Ÿè§‰ã€‚",
          detail: "å°±åƒç™½è‰²çš„æ¯›å‘åœ¨æœˆå…‰ä¸‹ä¸€æ ·ï¼Œä½ ä¹Ÿå¾ˆè€€çœ¼ã€‚",
        },

        // ç°çŒ« - ç†æ€§ç±»
        {
          cat: "gray",
          text: "è§‚å¯Ÿï¼Œç„¶åç­‰å¾…æ—¶æœºã€‚",
          detail: "åœ¨è·³è·ƒä¹‹å‰ï¼ŒçŒ«æ€»æ˜¯ä¼šå…ˆæ™ƒåŠ¨å±è‚¡ç„å‡†å¾ˆä¹…ã€‚",
        },
        {
          cat: "gray",
          text: "è¿™ä¸å€¼å¾—ä½ æµªè´¹ä¸€æ¬¡åˆç¡ã€‚",
          detail: "æœ‰äº›å¹²æ‰°åªæ˜¯çª—å¤–çš„éº»é›€ï¼Œçœ‹ä¸€çœ¼å°±å¤Ÿäº†ã€‚",
        },

        // æ©˜çŒ« - ä¹è§‚ç±»
        {
          cat: "orange",
          text: "å¤§æ©˜ä¸ºé‡ï¼Œå…ˆåƒé¥±å†è¯´ï¼",
          detail: "è‚šå­å¡«æ»¡äº†ï¼Œå¿ƒé‡Œçš„çƒ¦æ¼å°±æŒ¤ä¸å‡ºä½ç½®äº†ã€‚",
        },
        {
          cat: "orange",
          text: "ç”Ÿæ´»å°±åƒç½å¤´ï¼Œæ€»æœ‰æ‰“å¼€çš„åŠæ³•ã€‚",
          detail: "åªè¦ä½ å¤ŸåŠªåŠ›ï¼ˆæˆ–è€…å«å¾—å¤Ÿå¤§å£°ï¼‰ï¼Œæ€»ä¼šæœ‰æ”¶è·ã€‚",
        },

        // é»‘çŒ« - é…·é…·ç±»
        {
          cat: "black",
          text: "æˆ‘å°±åœ¨é»‘æš—é‡Œçœ‹ç€ä½ æŠ˜è…¾ã€‚",
          detail: "åˆ«è£…äº†ï¼Œå…¶å®ä½ å¿ƒé‡Œæ—©å°±æœ‰ç­”æ¡ˆäº†ï¼Œå¯¹å§ï¼Ÿ",
        },
        {
          cat: "black",
          text: "å“ˆæ°”ï¼ç¦»é‚£ä¸ªçƒ‚äººè¿œç‚¹ã€‚",
          detail: "æˆ‘çš„ç›´è§‰ä»æ²¡é”™è¿‡ï¼Œä½ çš„ä¹Ÿä¸€æ ·ã€‚",
        },
      ];

      // ç®€å•çŠ¶æ€ç®¡ç†
      const catArea = document.getElementById("cat-area");
      const catHitArea = document.getElementById("cat-hit-area");
      const catFigure = document.getElementById("cat-figure");
      const progressWrapper = document.getElementById("progress-wrapper");
      const progressBar = document.getElementById("progress-bar");
      const progressLabel = document.getElementById("progress-label");
      const resultFlash = document.getElementById("result-flash");
      const answerCard = document.getElementById("answer-card");
      const answerCardInner = document.getElementById("answer-card-inner");
      const answerTypePill = document.getElementById("answer-type-pill");
      const answerMain = document.getElementById("answer-main");
      const answerDetail = document.getElementById("answer-detail");
      const answerDismiss = document.getElementById("answer-dismiss");

      const audioPurr = document.getElementById("audio-purr");
      const audioMeow = document.getElementById("audio-meow");
      const audioPaper = document.getElementById("audio-paper");

      let energy = 0; // 0 - 100
      let hasStarted = false;
      let lastPointerPos = null;
      let resultShown = false;
      let particleId = 0;
      let currentCatColor = null;

      const MAX_ENERGY = 100;
      const ENERGY_PER_STROKE_UNIT = 0.08; // æ‰‹æŒ‡/é¼ æ ‡ç§»åŠ¨è·ç¦»å¯¹èƒ½é‡çš„å½±å“

      function revealProgressBar() {
        if (!hasStarted) {
          hasStarted = true;
          progressWrapper.classList.remove("opacity-0", "translate-y-3");
          progressWrapper.classList.add("opacity-100", "translate-y-0");
        }
      }

      function setEnergy(value) {
        const clamped = Math.max(0, Math.min(MAX_ENERGY, value));
        energy = clamped;

        const percentage = (clamped / MAX_ENERGY) * 100;
        progressBar.style.width = percentage + "%";

        if (clamped === 0) {
          progressLabel.textContent = "æ‘¸ä¸€æ‘¸è¯•è¯•çœ‹";
        } else if (clamped < 30) {
          progressLabel.textContent = "çŒ«å’ªåˆšåˆšé†’ï¼Œè¿˜åœ¨æ‰“å“ˆæ¬ â€¦";
        } else if (clamped < 70) {
          progressLabel.textContent = "å‘¼å™œå£°æ¸æ¸å˜å¤§äº†â€¦";
        } else if (clamped < MAX_ENERGY) {
          progressLabel.textContent = "å†å¤šæ‘¸ä¸€ä¼šå„¿ï¼Œé©¬ä¸Šå°±è¦å›ç­”ä½ äº†ï¼";
        } else {
          progressLabel.textContent = "çŒ«å’ªèƒ½é‡å·²æ»¡ï¼";
          if (!resultShown) {
            triggerResultSequence();
          }
        }
      }

      // ç²’å­ç‰¹æ•ˆï¼šåœ¨çŒ«å’ªåŒºåŸŸç”Ÿæˆä¸€å°æ’®æ˜Ÿæ˜Ÿ / è‚‰å«
      function spawnParticle(clientX, clientY) {
        const rect = catHitArea.getBoundingClientRect();
        const x = clientX - rect.left;
        const y = clientY - rect.top;

        const particle = document.createElement("span");
        particle.className = "particle";
        particle.style.left = x + "px";
        particle.style.top = y + "px";

        const dx = (Math.random() - 0.5) * 26;
        const dy = -20 - Math.random() * 20;
        particle.style.setProperty("--dx", dx + "px");
        particle.style.setProperty("--dy", dy + "px");

        const variants = ["ğŸ¾", "ğŸ¾", "ğŸ¾"];
        particle.textContent =
          variants[(particleId++ + variants.length) % variants.length];

        catHitArea.appendChild(particle);

        setTimeout(() => {
          particle.remove();
        }, 700);
      }

      function softShakeCat() {
        if (!catFigure) return;
        catFigure.classList.add("cat-shake");
        setTimeout(() => {
          catFigure.classList.remove("cat-shake");
        }, 260);
      }

      // 2x2 ç²¾çµå›¾ï¼šéšæœºé€‰æ‹©å…¶ä¸­ä¸€åªçŒ«
      function setRandomCatSprite() {
        if (!catFigure) return;
        const total = 4;
        const cols = 2;
        const index = Math.floor(Math.random() * total);
        const col = index % cols;
        const row = Math.floor(index / cols);
        const x = col * 100;
        const y = row * 100;
        catFigure.style.backgroundPosition = x + "% " + y + "%";

        // æ ¹æ®ç´¢å¼•æ˜ å°„å½“å‰çŒ«å’ªæ€§æ ¼/é¢œè‰²
        const colorMap = ["white", "gray", "orange", "black"];
        currentCatColor = colorMap[index] || null;
      }

      function playSafe(audioEl) {
        if (!audioEl) return;
        const playPromise = audioEl.play();
        if (playPromise && typeof playPromise.catch === "function") {
          playPromise.catch(() => {});
        }
      }

      // éšæœºæŒ‘é€‰ä¸€æ¡çŒ«å¼ç­”æ¡ˆï¼ˆä¼˜å…ˆä½¿ç”¨å½“å‰çŒ«å’ªå¯¹åº”çš„æ€§æ ¼æ± ï¼‰
      function pickRandomAnswer(catColor) {
        if (!catAnswers || catAnswers.length === 0) return null;

        let pool = catAnswers;
        if (catColor) {
          const filtered = catAnswers.filter((a) => a.cat === catColor);
          if (filtered.length > 0) {
            pool = filtered;
          }
        }

        const idx = Math.floor(Math.random() * pool.length);
        return pool[idx];
      }

      function getTypeLabelAndColor(catColor) {
        switch (catColor) {
          case "white":
            return {
              label: "ç™½çŒ« Â· æ¸©æŸ”æ²»æ„ˆ",
              bg: "bg-sky-50",
              text: "text-sky-700",
            };
          case "gray":
            return {
              label: "ç°çŒ« Â· å†·é™ç†æ€§",
              bg: "bg-slate-100",
              text: "text-slate-700",
            };
          case "orange":
            return {
              label: "æ©˜çŒ« Â· ä¹è§‚åƒè´§",
              bg: "bg-amber-50",
              text: "text-amber-700",
            };
          case "black":
            return {
              label: "é»‘çŒ« Â· ç¥ç§˜æ¯’èˆŒ",
              bg: "bg-purple-50",
              text: "text-purple-700",
            };
          default:
            return {
              label: "çŒ«å¼å“²å­¦",
              bg: "bg-amber-50",
              text: "text-amber-700",
            };
        }
      }

      function showAnswerCard(answer) {
        if (!answer) return;
        resultShown = true;

        const typeInfo = getTypeLabelAndColor(answer.cat);

        answerTypePill.textContent = typeInfo.label;
        answerTypePill.className =
          "inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium mb-1.5 " +
          typeInfo.bg +
          " " +
          typeInfo.text;

        answerMain.textContent = answer.text;
        answerDetail.textContent = answer.detail;

        // æ˜¾ç¤ºæ•´ä½“é®ç½©
        answerCard.classList.remove("invisible");
        answerCard.classList.remove("opacity-0");

        // è§¦å‘å¡ç‰‡æ‰è½åŠ¨ç”»
        if (!answerCardInner) return;
        answerCardInner.classList.remove("card-enter");
        void answerCardInner.offsetWidth; // å¼ºåˆ¶ reflow
        answerCardInner.classList.add("card-enter");

        playSafe(audioMeow);
        setTimeout(() => {
          playSafe(audioPaper);
        }, 120);
      }

      function hideAnswerCard() {
        answerCard.classList.add("opacity-0");
        setTimeout(() => {
          answerCard.classList.add("invisible");
        }, 220);
        resultShown = false;
        // é‡ç½®è¿›åº¦æ¡ï¼Œå‡†å¤‡ä¸‹ä¸€æ¬¡å åœ
        setEnergy(0);
        // æ¢ä¸€åªçŒ«ï¼Œå¼€å§‹ä¸‹ä¸€è½®å åœ
        setRandomCatSprite();
      }

      function triggerResultSequence() {
        // ç™½å…‰é—ªä¸€ä¸‹
        resultFlash.classList.remove("flash-active");
        void resultFlash.offsetWidth;
        resultFlash.classList.add("flash-active");

        // å‘¼å™œéœ‡åŠ¨
        softShakeCat();
        playSafe(audioPurr);

        const answer = pickRandomAnswer(currentCatColor);

        // ç¨å¾®ç­‰ä¸€ä¸‹ç™½å…‰å³°å€¼ï¼Œå†æ‰å¡ç‰‡
        setTimeout(() => {
          showAnswerCard(answer);
        }, 260);
      }

      function handlePointerMove(clientX, clientY) {
        revealProgressBar();

        const rect = catHitArea.getBoundingClientRect();
        // åªåœ¨å‘½ä¸­åŒºåŸŸå†…æ‰ç®—â€œæ‘¸çŒ«â€
        if (
          clientX < rect.left ||
          clientX > rect.right ||
          clientY < rect.top ||
          clientY > rect.bottom
        ) {
          lastPointerPos = null;
          return;
        }

        const current = { x: clientX, y: clientY };

        if (lastPointerPos) {
          const dx = current.x - lastPointerPos.x;
          const dy = current.y - lastPointerPos.y;
          const distance = Math.sqrt(dx * dx + dy * dy);

          if (distance > 0) {
            const gain = distance * ENERGY_PER_STROKE_UNIT;
            setEnergy(energy + gain);
          }
        }

        lastPointerPos = current;

        // æ¯æ¬¡æœ‰æ•ˆæŠšæ‘¸æ—¶å¶å°”ç”Ÿæˆä¸€ä¸ªå°ç²’å­
        if (Math.random() < 0.35) {
          spawnParticle(clientX, clientY);
        }
      }

      // é¼ æ ‡äº‹ä»¶
      let isMouseDown = false;

      catHitArea.addEventListener("mousedown", (e) => {
        isMouseDown = true;
        lastPointerPos = { x: e.clientX, y: e.clientY };
        revealProgressBar();
        softShakeCat();
        playSafe(audioPurr);
      });

      window.addEventListener("mouseup", () => {
        isMouseDown = false;
        lastPointerPos = null;
      });

      catHitArea.addEventListener("mousemove", (e) => {
        if (!isMouseDown) return;
        handlePointerMove(e.clientX, e.clientY);
      });

      // è§¦æ‘¸äº‹ä»¶ï¼ˆç§»åŠ¨ç«¯ï¼‰
      catHitArea.addEventListener(
        "touchstart",
        (e) => {
          if (e.touches.length > 0) {
            const t = e.touches[0];
            lastPointerPos = { x: t.clientX, y: t.clientY };
            revealProgressBar();
            softShakeCat();
            playSafe(audioPurr);
          }
        },
        { passive: true }
      );

      catHitArea.addEventListener(
        "touchmove",
        (e) => {
          if (e.touches.length > 0) {
            const t = e.touches[0];
            handlePointerMove(t.clientX, t.clientY);
          }
        },
        { passive: true }
      );

      catHitArea.addEventListener(
        "touchend",
        () => {
          lastPointerPos = null;
        },
        { passive: true }
      );

      // å…³é—­ç­”æ¡ˆå¡ç‰‡ï¼ˆç‚¹å‡»æŒ‰é’®æˆ–ä»»æ„é®ç½©åŒºåŸŸï¼‰
      answerDismiss.addEventListener("click", hideAnswerCard);
      answerCard.addEventListener("click", hideAnswerCard);

      // åˆå§‹çŠ¶æ€
      setRandomCatSprite();
      setEnergy(0);
    </script>
  </body>
</html>

